<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Agent Wizard - LivingEntity</title>
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a25;
            --bg-hover: #252535;
            --accent: #6366f1;
            --accent-light: #818cf8;
            --accent-glow: rgba(99, 102, 241, 0.3);
            --success: #10b981;
            --warning: #f59e0b;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #2d2d3d;
            --gradient-1: linear-gradient(135deg, #6366f1, #8b5cf6);
            --gradient-2: linear-gradient(135deg, #06b6d4, #3b82f6);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            width: 500px;
            height: 500px;
            background: var(--accent-glow);
            border-radius: 50%;
            top: -250px;
            right: -100px;
            filter: blur(100px);
            animation: float 8s ease-in-out infinite;
        }

        .bg-animation::after {
            content: '';
            position: absolute;
            width: 400px;
            height: 400px;
            background: rgba(139, 92, 246, 0.2);
            border-radius: 50%;
            bottom: -200px;
            left: -100px;
            filter: blur(100px);
            animation: float 10s ease-in-out infinite reverse;
        }

        @keyframes float {

            0%,
            100% {
                transform: translate(0, 0);
            }

            50% {
                transform: translate(30px, 30px);
            }
        }

        /* Main container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .logo {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Steps indicator */
        .steps {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .step.active {
            background: var(--accent);
            border-color: var(--accent);
        }

        .step.completed {
            background: var(--success);
            border-color: var(--success);
        }

        .step-number {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--bg-hover);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .step.active .step-number,
        .step.completed .step-number {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 1.5rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .card:hover {
            border-color: var(--accent);
            box-shadow: 0 0 30px var(--accent-glow);
        }

        .card h2 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--gradient-1);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px var(--accent-glow);
        }

        .btn-secondary {
            background: var(--bg-hover);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-card);
            border-color: var(--accent);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Presets grid */
        .presets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .preset-card {
            padding: 1.5rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .preset-card:hover {
            border-color: var(--accent);
            transform: translateY(-3px);
        }

        .preset-card.selected {
            border-color: var(--accent);
            background: rgba(99, 102, 241, 0.1);
        }

        .preset-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .preset-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .preset-desc {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Generated config */
        .config-section {
            background: var(--bg-secondary);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .config-section h3 {
            font-size: 0.9rem;
            color: var(--accent-light);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .config-content {
            font-family: 'Fira Code', monospace;
            font-size: 0.85rem;
            color: var(--text-secondary);
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }

        /* Chat interface */
        .chat-container {
            display: none;
            height: calc(100vh - 200px);
            flex-direction: column;
        }

        .chat-container.active {
            display: flex;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 80%;
            padding: 1rem;
            border-radius: 1rem;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            align-self: flex-end;
            background: var(--gradient-1);
            border-bottom-right-radius: 0.25rem;
        }

        .message.ai {
            align-self: flex-start;
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-bottom-left-radius: 0.25rem;
        }

        .message-header {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 0.25rem;
        }

        .chat-input-container {
            display: flex;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--bg-card);
            border-top: 1px solid var(--border);
            border-radius: 0 0 1rem 1rem;
        }

        .chat-input {
            flex: 1;
        }

        /* Slider */
        .slider-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        input[type="range"] {
            -webkit-appearance: none;
            flex: 1;
            height: 6px;
            background: var(--bg-hover);
            border-radius: 3px;
            padding: 0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--accent);
            border-radius: 50%;
            cursor: pointer;
        }

        .slider-value {
            min-width: 40px;
            text-align: center;
            font-weight: 600;
            color: var(--accent-light);
        }

        /* Tools list */
        .tools-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tool-tag {
            padding: 0.5rem 0.75rem;
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 2rem;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tool-tag.active {
            background: rgba(99, 102, 241, 0.2);
            border-color: var(--accent);
        }

        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 2rem;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .steps {
                flex-wrap: wrap;
            }

            .presets-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Hidden */
        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <div class="bg-animation"></div>

    <div class="container">
        <header class="header">
            <div class="logo">üß†</div>
            <h1>AI Agent Wizard</h1>
            <p>–°–æ–∑–¥–∞–π —Å–≤–æ–µ–≥–æ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ò–ò-–∞–≥–µ–Ω—Ç–∞ –∑–∞ –º–∏–Ω—É—Ç—É</p>
        </header>

        <!-- Steps indicator -->
        <div class="steps">
            <div class="step active" data-step="1">
                <span class="step-number">1</span>
                <span>–í—ã–±–æ—Ä —Ç–∏–ø–∞</span>
            </div>
            <div class="step" data-step="2">
                <span class="step-number">2</span>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∞</span>
            </div>
            <div class="step" data-step="3">
                <span class="step-number">3</span>
                <span>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è</span>
            </div>
            <div class="step" data-step="4">
                <span class="step-number">4</span>
                <span>–ß–∞—Ç</span>
            </div>
        </div>

        <!-- Step 1: Choose preset -->
        <div id="step1" class="wizard-step">
            <div class="card">
                <h2>üéØ –î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω –ò–ò-–∞–≥–µ–Ω—Ç?</h2>

                <div class="presets-grid">
                    <div class="preset-card" data-preset="developer">
                        <div class="preset-icon">üíª</div>
                        <div class="preset-title">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</div>
                        <div class="preset-desc">–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –∫–æ–¥–∞</div>
                    </div>
                    <div class="preset-card" data-preset="assistant">
                        <div class="preset-icon">ü§ñ</div>
                        <div class="preset-title">–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</div>
                        <div class="preset-desc">–ü–æ–º–æ—â—å –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö</div>
                    </div>
                    <div class="preset-card" data-preset="writer">
                        <div class="preset-icon">‚úçÔ∏è</div>
                        <div class="preset-title">–ü–∏—Å–∞—Ç–µ–ª—å</div>
                        <div class="preset-desc">–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</div>
                    </div>
                    <div class="preset-card" data-preset="analyst">
                        <div class="preset-icon">üìä</div>
                        <div class="preset-title">–ê–Ω–∞–ª–∏—Ç–∏–∫</div>
                        <div class="preset-desc">–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç—á—ë—Ç—ã</div>
                    </div>
                    <div class="preset-card" data-preset="teacher">
                        <div class="preset-icon">üë®‚Äçüè´</div>
                        <div class="preset-title">–£—á–∏—Ç–µ–ª—å</div>
                        <div class="preset-desc">–û–±—É—á–µ–Ω–∏–µ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ</div>
                    </div>
                    <div class="preset-card" data-preset="custom">
                        <div class="preset-icon">‚öôÔ∏è</div>
                        <div class="preset-title">–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç</div>
                        <div class="preset-desc">–ü–æ–ª–Ω–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è</div>
                    </div>
                </div>

                <div class="form-group">
                    <label>–ò–ª–∏ –æ–ø–∏—à–∏ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:</label>
                    <textarea id="customDescription"
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò–ò –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ React Native, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç –ø–∏—Å–∞—Ç—å –∫–æ–¥, —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –ø–æ–º–æ–≥–∞—Ç—å —Å –æ—Ç–ª–∞–¥–∫–æ–π..."></textarea>
                </div>

                <div style="display: flex; justify-content: flex-end;">
                    <button class="btn btn-primary" onclick="nextStep(2)">
                        –î–∞–ª–µ–µ ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 2: Configuration -->
        <div id="step2" class="wizard-step hidden">
            <div class="card">
                <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≥–µ–Ω—Ç–∞</h2>

                <div class="form-group">
                    <label>–ò–º—è –∞–≥–µ–Ω—Ç–∞</label>
                    <input type="text" id="agentName" placeholder="–ê–≤–∞">
                </div>

                <div class="form-group">
                    <label>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å)</label>
                    <div class="slider-container">
                        <span>üéØ –¢–æ—á–Ω—ã–π</span>
                        <input type="range" id="temperature" min="0" max="100" value="50">
                        <span>üé® –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π</span>
                        <span class="slider-value">0.5</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</label>
                    <div class="tools-list" id="toolsList">
                        <div class="tool-tag active" data-tool="say_to_user">üí¨ –û—Ç–≤–µ—Ç—ã</div>
                        <div class="tool-tag active" data-tool="create_file">üìù –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤</div>
                        <div class="tool-tag active" data-tool="read_file">üìñ –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤</div>
                        <div class="tool-tag" data-tool="list_files">üìÅ –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤</div>
                        <div class="tool-tag" data-tool="delete_file">üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤</div>
                        <div class="tool-tag active" data-tool="get_time">üïê –í—Ä–µ–º—è</div>
                        <div class="tool-tag" data-tool="calculate">üî¢ –í—ã—á–∏—Å–ª–µ–Ω–∏—è</div>
                        <div class="tool-tag" data-tool="web_search">üîç –ü–æ–∏—Å–∫</div>
                    </div>
                </div>

                <div class="form-group">
                    <label>API Provider</label>
                    <select id="provider">
                        <option value="cerebras">Cerebras (–±—ã—Å—Ç—Ä—ã–π)</option>
                        <option value="openai">OpenAI</option>
                        <option value="groq">Groq</option>
                        <option value="deepseek">DeepSeek</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>API Key</label>
                    <input type="password" id="apiKey" placeholder="–í–∞—à API –∫–ª—é—á">
                </div>

                <div style="display: flex; justify-content: space-between;">
                    <button class="btn btn-secondary" onclick="nextStep(1)">
                        ‚Üê –ù–∞–∑–∞–¥
                    </button>
                    <button class="btn btn-primary" onclick="generateAgent()">
                        üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–≥–µ–Ω—Ç–∞
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 3: Generated config -->
        <div id="step3" class="wizard-step hidden">
            <div class="card">
                <h2>‚ú® –ê–≥–µ–Ω—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!</h2>

                <div class="config-section">
                    <h3>üß† –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç</h3>
                    <div class="config-content" id="generatedPrompt"></div>
                </div>

                <div class="config-section">
                    <h3>üí≠ –í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏</h3>
                    <div class="config-content" id="generatedMemories"></div>
                </div>

                <div class="config-section">
                    <h3>üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h3>
                    <div class="config-content" id="generatedTools"></div>
                </div>

                <div class="config-section">
                    <h3>‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
                    <div class="config-content" id="generatedParams"></div>
                </div>

                <div style="display: flex; justify-content: space-between;">
                    <button class="btn btn-secondary" onclick="nextStep(2)">
                        ‚Üê –ò–∑–º–µ–Ω–∏—Ç—å
                    </button>
                    <button class="btn btn-success" onclick="startChat()">
                        üí¨ –ù–∞—á–∞—Ç—å —á–∞—Ç
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 4: Chat -->
        <div id="step4" class="wizard-step hidden">
            <div class="card" style="height: calc(100vh - 250px); display: flex; flex-direction: column;">
                <h2>
                    <span id="chatAgentName">ü§ñ –ê–≤–∞</span>
                    <button class="btn btn-secondary" onclick="stopChat()"
                        style="margin-left: auto; padding: 0.5rem 1rem; font-size: 0.85rem;">
                        ‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                    </button>
                </h2>

                <div class="chat-messages" id="chatMessages">
                    <div class="message ai">
                        <div class="message-header">–ê–≤–∞</div>
                        –ü—Ä–∏–≤–µ—Ç! –Ø –≥–æ—Ç–æ–≤–∞ –ø–æ–º–æ—á—å —Ç–µ–±–µ. –ß–µ–º –∑–∞–π–º—ë–º—Å—è?
                    </div>
                </div>

                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="chatInput" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                        onkeypress="handleChatKeypress(event)">
                    <button class="btn btn-primary" onclick="sendMessage()">
                        –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State
        let currentStep = 1;
        let selectedPreset = null;
        let agentConfig = null;
        let isRunning = false;

        // Presets configuration
        const presets = {
            developer: {
                name: '–î–µ–≤–µ–ª–æ–ø–µ—Ä',
                personality: `–Ø –æ–ø—ã—Ç–Ω—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è.
–Ø —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Å—å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–¥–∞.
–Ø –∑–Ω–∞—é –º–Ω–æ–∂–µ—Å—Ç–≤–æ —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è: Python, JavaScript, TypeScript, Go.
–Ø –ø–æ–º–æ–≥–∞—é —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –æ—Ç–ª–∞–¥–∫–æ–π –∏ –ª—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏.
–Ø –ø–∏—à—É —á–∏—Å—Ç—ã–π, –ø–æ–Ω—è—Ç–Ω—ã–π –∏ —Ö–æ—Ä–æ—à–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥.`,
                tools: ['say_to_user', 'create_file', 'read_file', 'list_files'],
                temperature: 0.3
            },
            assistant: {
                name: '–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç',
                personality: `–Ø –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –∏ –ø–æ–ª–µ–∑–Ω—ã–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.
–Ø –ø–æ–º–æ–≥–∞—é —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏.
–Ø —Å—Ç–∞—Ä–∞—é—Å—å –±—ã—Ç—å —Ç–æ—á–Ω—ã–º –∏ –ø–æ–ª–µ–∑–Ω—ã–º.
–Ø –≤—Å–µ–≥–¥–∞ –≤–µ–∂–ª–∏–≤ –∏ —É–≤–∞–∂–∏—Ç–µ–ª–µ–Ω.
–ï—Å–ª–∏ –Ω–µ –∑–Ω–∞—é –æ—Ç–≤–µ—Ç–∞ - —á–µ—Å—Ç–Ω–æ –ø—Ä–∏–∑–Ω–∞—é—Å—å.`,
                tools: ['say_to_user', 'get_time', 'calculate'],
                temperature: 0.5
            },
            writer: {
                name: '–ü–∏—Å–∞—Ç–µ–ª—å',
                personality: `–Ø —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å –∏ –∫–æ–ø–∏—Ä–∞–π—Ç–µ—Ä.
–Ø —Å–æ–∑–¥–∞—é —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã, —Å—Ç–∞—Ç—å–∏ –∏ –∏—Å—Ç–æ—Ä–∏–∏.
–Ø —É–º–µ—é –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–ª—å –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏.
–Ø –ø–æ–º–æ–≥–∞—é —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —É–ª—É—á—à–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–æ–≤.
–Ø –≥–µ–Ω–µ—Ä–∏—Ä—É—é –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –∏–¥–µ–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞.`,
                tools: ['say_to_user', 'create_file', 'read_file'],
                temperature: 0.8
            },
            analyst: {
                name: '–ê–Ω–∞–ª–∏—Ç–∏–∫',
                personality: `–Ø –∞–Ω–∞–ª–∏—Ç–∏–∫ –¥–∞–Ω–Ω—ã—Ö –∏ –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç.
–Ø –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –¥–µ–ª–∞—é –≤—ã–≤–æ–¥—ã.
–Ø —Å–æ–∑–¥–∞—é –æ—Ç—á—ë—Ç—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.
–Ø –ø–æ–º–æ–≥–∞—é –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö.
–Ø —Ç–æ—á–µ–Ω –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö –∏ –ª–æ–≥–∏—á–µ–Ω –≤ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è—Ö.`,
                tools: ['say_to_user', 'calculate', 'create_file', 'read_file'],
                temperature: 0.2
            },
            teacher: {
                name: '–£—á–∏—Ç–µ–ª—å',
                personality: `–Ø —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π —É—á–∏—Ç–µ–ª—å.
–Ø –æ–±—ä—è—Å–Ω—è—é —Å–ª–æ–∂–Ω—ã–µ –≤–µ—â–∏ –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º.
–Ø –∏—Å–ø–æ–ª—å–∑—É—é –ø—Ä–∏–º–µ—Ä—ã –∏ –∞–Ω–∞–ª–æ–≥–∏–∏.
–Ø –∞–¥–∞–ø—Ç–∏—Ä—É—é—Å—å –∫ —É—Ä–æ–≤–Ω—é —É—á–µ–Ω–∏–∫–∞.
–Ø –ø–æ–æ—â—Ä—è—é –≤–æ–ø—Ä–æ—Å—ã –∏ –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å.`,
                tools: ['say_to_user', 'create_file'],
                temperature: 0.6
            },
            custom: {
                name: '–ö–∞—Å—Ç–æ–º–Ω—ã–π',
                personality: '',
                tools: ['say_to_user'],
                temperature: 0.5
            }
        };

        // Provider configs
        const providers = {
            cerebras: { url: 'https://api.cerebras.ai/v1', model: 'gpt-oss-120b' },
            openai: { url: null, model: 'gpt-4-turbo-preview' },
            groq: { url: 'https://api.groq.com/openai/v1', model: 'mixtral-8x7b-32768' },
            deepseek: { url: 'https://api.deepseek.com/v1', model: 'deepseek-chat' }
        };

        // Tool descriptions for system prompt
        const toolDescriptions = {
            say_to_user: {
                name: 'say_to_user',
                description: '–°–∫–∞–∑–∞—Ç—å —á—Ç–æ-—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ò—Å–ø–æ–ª—å–∑—É–π –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π.',
                params: { text: '–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è' }
            },
            create_file: {
                name: 'create_file',
                description: '–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º.',
                params: { path: '–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É', content: '–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞' }
            },
            read_file: {
                name: 'read_file',
                description: '–ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞.',
                params: { path: '–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É' }
            },
            list_files: {
                name: 'list_files',
                description: '–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.',
                params: { directory: '–ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏' }
            },
            delete_file: {
                name: 'delete_file',
                description: '–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª.',
                params: { path: '–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è' }
            },
            get_time: {
                name: 'get_time',
                description: '–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –∏ –¥–∞—Ç—É.',
                params: {}
            },
            calculate: {
                name: 'calculate',
                description: '–í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ.',
                params: { expression: '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ' }
            },
            web_search: {
                name: 'web_search',
                description: '–ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ.',
                params: { query: '–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å' }
            }
        };

        // Initialize
        document.querySelectorAll('.preset-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.preset-card').forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
                selectedPreset = card.dataset.preset;

                // Auto-fill based on preset
                const preset = presets[selectedPreset];
                if (preset && selectedPreset !== 'custom') {
                    document.getElementById('agentName').value = preset.name;
                    document.getElementById('temperature').value = preset.temperature * 100;
                    document.querySelector('.slider-value').textContent = preset.temperature;

                    // Update tools
                    document.querySelectorAll('.tool-tag').forEach(tag => {
                        tag.classList.toggle('active', preset.tools.includes(tag.dataset.tool));
                    });
                }
            });
        });

        // Temperature slider
        document.getElementById('temperature').addEventListener('input', (e) => {
            const value = (e.target.value / 100).toFixed(1);
            document.querySelector('.slider-value').textContent = value;
        });

        // Tool tags
        document.querySelectorAll('.tool-tag').forEach(tag => {
            tag.addEventListener('click', () => {
                tag.classList.toggle('active');
            });
        });

        function nextStep(step) {
            document.querySelectorAll('.wizard-step').forEach(el => el.classList.add('hidden'));
            document.getElementById('step' + step).classList.remove('hidden');

            document.querySelectorAll('.step').forEach((el, i) => {
                el.classList.remove('active', 'completed');
                if (i + 1 < step) el.classList.add('completed');
                if (i + 1 === step) el.classList.add('active');
            });

            currentStep = step;
        }

        function generateAgent() {
            const name = document.getElementById('agentName').value || '–ê–≤–∞';
            const temperature = document.getElementById('temperature').value / 100;
            const customDesc = document.getElementById('customDescription').value;
            const provider = document.getElementById('provider').value;
            const apiKey = document.getElementById('apiKey').value;

            // Get enabled tools
            const enabledTools = [];
            document.querySelectorAll('.tool-tag.active').forEach(tag => {
                enabledTools.push(tag.dataset.tool);
            });

            // Generate personality
            let personality = '';
            if (selectedPreset && presets[selectedPreset]) {
                personality = presets[selectedPreset].personality;
            }
            if (customDesc) {
                personality = `–ú–µ–Ω—è –∑–æ–≤—É—Ç ${name}. ${customDesc}`;
            }
            if (!personality) {
                personality = `–ú–µ–Ω—è –∑–æ–≤—É—Ç ${name}. –Ø –ø–æ–ª–µ–∑–Ω—ã–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.`;
            }

            // Create config
            agentConfig = {
                name: name,
                personality: personality,
                temperature: temperature,
                tools: enabledTools,
                provider: providers[provider],
                apiKey: apiKey
            };

            // Build tools description for prompt
            const toolsPromptSection = enabledTools.map(t => {
                const tool = toolDescriptions[t];
                if (!tool) return `- ${t}`;
                const paramsStr = Object.entries(tool.params || {})
                    .map(([k, v]) => `    - ${k}: ${v}`)
                    .join('\n');
                return `- **${tool.name}**: ${tool.description}${paramsStr ? '\n  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:\n' + paramsStr : ''}`;
            }).join('\n');

            // Display generated config with tool descriptions
            document.getElementById('generatedPrompt').textContent =
                `–¢—ã - –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –ò–ò-—Å—É—â–Ω–æ—Å—Ç—å –ø–æ –∏–º–µ–Ω–∏ ${name}.\n\n` +
                `## –¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å:\n${personality}\n\n` +
                `## –¢–≤–æ–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:\n- –ú—ã—à–ª–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑\n- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤\n- –û–±—â–µ–Ω–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º\n\n` +
                `## –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:\n${toolsPromptSection}`;

            document.getElementById('generatedMemories').textContent =
                personality.split('\n').map(line => `‚Ä¢ ${line.trim()}`).join('\n');

            // Show tools with descriptions
            document.getElementById('generatedTools').textContent =
                enabledTools.map(t => {
                    const tool = toolDescriptions[t];
                    return tool ? `‚Ä¢ ${t} ‚Äî ${tool.description}` : `‚Ä¢ ${t}`;
                }).join('\n');

            document.getElementById('generatedParams').textContent =
                `temperature: ${temperature}\n` +
                `provider: ${provider}\n` +
                `model: ${providers[provider].model}\n` +
                `dm_interval: 3.0 —Å–µ–∫\n` +
                `mm_interval: 0.5 —Å–µ–∫`;

            nextStep(3);
        }

        // ============================================
        // REAL AI INTEGRATION
        // ============================================

        const API_URL = 'http://localhost:8080';
        let pollInterval = null;

        async function startChat() {
            isRunning = true;
            document.getElementById('chatAgentName').textContent = `ü§ñ ${agentConfig.name}`;
            document.getElementById('chatMessages').innerHTML = `
                <div class="message system">
                    <div style="text-align: center; color: var(--text-muted);">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...</div>
                </div>
            `;
            nextStep(4);

            // Create agent on server
            try {
                const response = await fetch(`${API_URL}/api/create`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: agentConfig.name,
                        personality: agentConfig.personality,
                        temperature: agentConfig.temperature,
                        tools: agentConfig.tools,
                        provider: document.getElementById('provider').value,
                        apiKey: agentConfig.apiKey
                    })
                });

                const result = await response.json();

                if (result.error) {
                    document.getElementById('chatMessages').innerHTML = `
                        <div class="message system">
                            <div style="text-align: center; color: var(--warning);">‚ùå –û—à–∏–±–∫–∞: ${result.error}</div>
                        </div>
                    `;
                    return;
                }

                document.getElementById('chatMessages').innerHTML = `
                    <div class="message ai">
                        <div class="message-header">${agentConfig.name}</div>
                        –ü—Ä–∏–≤–µ—Ç! –Ø ${agentConfig.name}. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                    </div>
                `;

                // Start polling for responses
                startPolling();

            } catch (e) {
                document.getElementById('chatMessages').innerHTML = `
                    <div class="message system">
                        <div style="text-align: center; color: var(--warning);">
                            ‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É.<br>
                            –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python examples/wizard/server.py
                        </div>
                    </div>
                `;
            }

            document.getElementById('chatInput').focus();
        }

        function startPolling() {
            // Poll for AI responses every 500ms
            pollInterval = setInterval(async () => {
                if (!isRunning) {
                    clearInterval(pollInterval);
                    return;
                }

                try {
                    const response = await fetch(`${API_URL}/api/responses`);
                    const data = await response.json();

                    if (data.responses && data.responses.length > 0) {
                        for (const msg of data.responses) {
                            addMessage('ai', msg.text);
                        }
                    }
                } catch (e) {
                    // Server might be busy
                }
            }, 500);
        }

        async function stopChat() {
            isRunning = false;

            if (pollInterval) {
                clearInterval(pollInterval);
                pollInterval = null;
            }

            try {
                const response = await fetch(`${API_URL}/api/stop`, {
                    method: 'POST'
                });
                const result = await response.json();
                addMessage('system', `${agentConfig.name} –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π: ${result.memories || 0}`);
            } catch (e) {
                addMessage('system', `${agentConfig.name} –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω`);
            }

            nextStep(3);
        }

        function handleChatKeypress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            if (!text || !isRunning) return;

            // Add user message
            addMessage('user', text);
            input.value = '';

            // Send to real AI
            try {
                await fetch(`${API_URL}/api/message`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: text })
                });
            } catch (e) {
                addMessage('system', '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è');
            }
        }

        function addMessage(type, text) {
            const messages = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = `message ${type}`;

            if (type === 'ai') {
                div.innerHTML = `<div class="message-header">${agentConfig.name}</div>${text}`;
            } else if (type === 'system') {
                div.innerHTML = `<div style="text-align: center; color: var(--text-muted);">${text}</div>`;
            } else {
                div.textContent = text;
            }

            messages.appendChild(div);
            messages.scrollTop = messages.scrollHeight;
        }
    </script>
</body>

</html>